const e=require(`./profiles-iKAaapmR.cjs`);function t(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,``);return t.indexOf(`/`)===-1?t:t.split(`/`)[0]}function n(e){try{if(e===`full`)return{full:!0};if(e===`square`)return{square:!0};let t=e.startsWith(`pct:`),n=e.substr(t?4:0).split(`,`),r=n.map(e=>parseFloat(e));return{x:r[0],y:r[1],w:r[2],h:r[3],percent:t}}catch{throw Error(`Expected 'full', 'square' or 'x,y,w,h'. Found `+e)}}function r(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]===`^`&&(t.upscaled=!0,e=e.slice(1)),e===`max`||e===`full`)return t.max=!0,t.serialiseAsFull=e===`full`,t;if(e[0]===`!`&&(t.confined=!0,e=e.slice(1)),e[0]===`p`)return t.percentScale=parseFloat(e.slice(4)),t;let n=e.split(`,`).map(e=>e.trim());return n.length&&(n[0]!==``&&(t.width=parseInt(n[0],10)),n[1]!==``&&(t.height=parseInt(n[1],10))),t}function i(e){let t={angle:0};if(e[0]===`!`&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw Error(`Invalid rotation ${e}`);return t}function a(e,t=``){let n=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!n)throw Error(`Invalid or unknown input ${e}`);let r=n[2],i=n[3],a=n[4];if(a[0]===`/`&&(a=a.substring(1)),t.length>0){if(t[0]===`/`&&(t=t.substring(1)),t!==a.substring(0,t.length))throw Error(`Path does not start with prefix (path: ${a}, prefix: ${t})`);a=a.substring(t.length)}return{scheme:r,server:i,path:a,prefix:t}}function o(e,t=``){let{path:o,scheme:s,server:c,prefix:l}=a(e,t),u=o.split(`/`).reverse(),[d,f,p,m,...h]=u,g=h.reverse().filter(Boolean).join(`/`);if(u.length===1||d===``)return{type:`base`,scheme:s,server:c,prefix:l,identifier:g};if(d===`info.json`){let[,...e]=u;return{type:`info`,scheme:s,server:c,prefix:l,identifier:e.reverse().filter(Boolean).join(`/`)}}if(s===void 0||c===void 0||o===void 0||m===void 0||p===void 0||f===void 0||d===void 0)throw Error(`Invalid image service URL`);let[_=``,v=``]=d.split(`.`);return{type:`image`,scheme:s,server:c,prefix:l,identifier:g,originalPath:o,region:n(m),size:r(p),rotation:i(f),quality:_,format:v}}function s(t){let n=e.level2Support.indexOf(t)!==-1;if(n)return e.level2;let r=e.level1Support.indexOf(t)!==-1;return r?e.level1:e.level0}function c(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],n={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let e of t){if(typeof e==`string`&&(e=s(e)),!e)continue;if(e.formats)for(let t of e.formats)n.extraFormats.indexOf(t)===-1&&n.extraFormats.push(t);if(e.qualities)for(let t of e.qualities)n.extraQualities.indexOf(t)===-1&&n.extraQualities.push(t);if(e.supports)for(let t of e.supports)n.extraFeatures.indexOf(t)===-1&&n.extraFeatures.push(t);if(e.maxHeight&&(n.maxHeight=e.maxHeight),e.maxWidth&&(n.maxWidth=e.maxWidth),e.maxArea&&(n.maxArea=e.maxArea),e.extraFormats)for(let t of e.extraFormats)n.extraFormats.indexOf(t)===-1&&n.extraFormats.push(t);if(e.extraQualities)for(let t of e.extraQualities)n.extraQualities.indexOf(t)===-1&&n.extraQualities.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)n.extraFeatures.indexOf(t)===-1&&n.extraFeatures.push(t);e.maxHeight&&(n.maxHeight=e.maxHeight),e.maxWidth&&(n.maxWidth=e.maxWidth),e.maxArea&&(n.maxArea=e.maxArea)}if(e.extraFormats)for(let t of e.extraFormats)n.extraFormats.indexOf(t)===-1&&n.extraFormats.push(t);if(e.extraFeatures)for(let t of e.extraFeatures)n.extraFeatures.indexOf(t)===-1&&n.extraFeatures.push(t);if(e.extraQualities)for(let t of e.extraQualities)n.extraQualities.indexOf(t)===-1&&n.extraQualities.push(t);return n}function l(t){let n=Array.isArray(t.profile)?t.profile:[t.profile];for(let t of n)if(typeof t==`string`&&e.onlyLevel0.indexOf(t)!==-1)return!0;return!1}function u(e){if(e[`@id`])return e[`@id`];if(e.id)return e.id}function d(t){if(!t||!t.profile||!u(t))return!1;let n=Array.isArray(t.profile)?t.profile:[t.profile];for(let t of n)if(typeof t==`string`&&e.imageServiceProfiles.indexOf(t)!==-1)return!0;return!1}function f(t,n){if(!d(t))return[!1,`Not a valid image service`];n.extraFeatures=n.extraFeatures?n.extraFeatures:[];let r=c(t);if(n.exactSize){let r=!1;if(t.sizes)for(let i of t.sizes)i.width&&i.width===n.exactSize.width&&(e.extraFeatures.indexOf(`sizeByW`)===-1?i.height&&i.height===n.exactSize.height&&(r=!0):r=!0),i.height&&i.height===n.exactSize.height&&(e.extraFeatures.indexOf(`sizeByH`)===-1?i.width&&i.width===n.exactSize.width&&(r=!0):r=!0);r||(n.maxWidth=Math.max(n.maxWidth||0,n.exactSize.width||0)||void 0,n.maxHeight=Math.max(n.maxHeight||0,n.exactSize.height||0)||void 0,n.maxArea=Math.max(n.maxArea||0,(n.exactSize.width&&n.exactSize.height?n.exactSize.width*n.exactSize.height:n.maxArea)||0)||void 0,!n.exactSize.height&&n.exactSize.width?n.extraFeatures.indexOf(`sizeByW`)===-1&&n.extraFeatures.push(`sizeByW`):!n.exactSize.width&&n.exactSize.height&&n.extraFeatures.indexOf(`sizeByH`)===-1&&n.extraFeatures.push(`sizeByH`))}if(n.maxArea&&r.maxArea&&n.maxArea>r.maxArea)return[!1,`Max area is ${r.maxArea}`];if(n.maxWidth&&r.maxWidth&&n.maxWidth>r.maxWidth)return[!1,`Max width is ${r.maxWidth}`];if(n.maxHeight&&r.maxHeight&&n.maxHeight>r.maxHeight)return[!1,`Max height is ${r.maxHeight}`];if(n.extraFeatures){let e=[];for(let t of n.extraFeatures)r.extraFeatures.indexOf(t)===-1&&e.push(t);if(e.length)return[!1,`Missing features: ${e.join(`, `)}`]}if(n.extraFormats){let e=[];for(let t of n.extraFormats)r.extraFormats.indexOf(t)===-1&&e.push(t);if(e.length)return[!1,`Missing formats: ${e.join(`, `)}`]}if(n.extraQualities){let e=[];for(let t of n.extraQualities)r.extraQualities.indexOf(t)===-1&&e.push(t);if(e.length)return[!1,`Missing qualities: ${e.join(`, `)}`]}return[!0]}function p(t){if(!d(t))return!1;let n=Array.isArray(t.profile)?t.profile:[t.profile];for(let t of n)if(typeof t==`string`){if(e.level1Support.indexOf(t)!==-1)return!0}else{let e=[...t.supports||[],...t.extraFeatures||[]];if(e.indexOf(`regionByPx`)!==-1&&(e.indexOf(`sizeByW`)!==-1||e.indexOf(`sizeByWh`)!==-1))return!0}return!1}function m(e,t){return f(e,{extraFormats:[t]})}function h(e,t){if(t.type!==`image`)return[!0];let n=[];if(t.rotation.mirror&&n.push(`mirroring`),t.region.percent&&n.push(`regionByPct`),t.region.square?n.push(`regionSquare`):t.region.full||n.push(`regionByPx`),t.rotation.angle){let e=t.rotation.angle%90;e?n.push(`rotationArbitrary`):n.push(`rotationBy90s`)}t.size.confined&&n.push(`sizeByConfinedWh`),!t.size.width&&t.size.height&&n.push(`sizeByH`),t.size.percentScale&&n.push(`sizeByPct`);let r=(e.sizes||[]).find(e=>e.width===t.size.width&&!t.size.height||e.height===t.size.height&&!t.size.width||e.height===t.size.height&&e.width===t.size.width);r?n.push(`sizeByWhListed`):(t.size.width&&!t.size.height&&n.push(`sizeByW`),t.size.width&&t.size.height&&n.push(`sizeByWh`)),t.size.upscaled&&n.push(`sizeUpscaling`);let[i,a]=f(e,{extraFeatures:n,extraQualities:[t.quality],extraFormats:[t.format],exactSize:t.size});return i?[!0]:[!1,a]}function g({x:e=0,y:t=0,w:n,h:r,full:i,square:a,percent:o}){if(i)return`full`;if(a)return`square`;if(n===void 0||r===void 0)throw Error(`RegionParameter: invalid region`);let s=`${e},${t},${n},${r}`;return o?`pct:${s}`:s}function _({max:e,percentScale:t,upscaled:n,confined:r,width:i,height:a,serialiseAsFull:o,version:s}){let c=[];return n&&c.push(`^`),e?(c.push(o?`full`:`max`),c.join(``)):(r&&c.push(`!`),t&&c.push(`pct:${t}`),i&&c.push(`${i}`),c.push(`,`),a&&s===3&&c.push(`${a}`),c.join(``))}function v(e){return`${e.mirror?`!`:``}${(e.angle||0)%360}`}function y(e,t){let n=e.prefix.startsWith(`/`)?e.prefix.substring(1):e.prefix,r=`${e.scheme}://${e.server}/${n?`${n}/`:``}${e.identifier}`;if(e.type===`base`)return r;if(e.type===`info`)return`${r}/info.json`;let{size:i}=e,{region:a,rotation:o,format:s,quality:c}=e;if(t){let e=t[`@context`]?Array.isArray(t[`@context`])?t[`@context`]:[t[`@context`]]:[],n=e.indexOf(`http://iiif.io/api/image/2/context.json`)!==-1,r=e.indexOf(`http://iiif.io/api/image/3/context.json`)!==-1;if((i.width===t.width&&!i.height||i.height===t.height&&!i.width||i.width===t.width&&i.height===t.height)&&(i={...i,max:!0}),n&&(i.max&&!i.serialiseAsFull&&(i={...i,serialiseAsFull:!0}),!i.max&&i.width&&i.height&&(i={...i,height:void 0}),i={...i,version:2}),r){if(i.max&&i.serialiseAsFull&&(i={...i,serialiseAsFull:!1}),i.width&&!i.height&&t.width&&t.height){let e=t.height/t.width;i={...i,height:Math.ceil(i.width*e)}}i={...i,version:3}}}return[r,g(a),_(i),v(o),`${c}.${s}`].filter(Boolean).join(`/`)}function b(e,t){return y({...e,type:`info`},t)}function x(e){return e.endsWith(`info.json`)?e:e.endsWith(`/`)?`${e}info.json`:`${e}/info.json`}function S(e){let t=o(x(e.id));if(t.type!==`info`)throw Error(`Invalid service URL`);let n=c(e);return{identifier:t.identifier,originalPath:``,server:t.server,prefix:t.prefix,scheme:t.scheme,type:`image`,quality:n.extraQualities.indexOf(`default`)===-1?n.extraQualities[0]:`default`,region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:`jpg`,rotation:{angle:0}}}function C(e,t,n){let r=n.length,i=[];for(let t=0;t<r;t++){let r=n[t];if(!r)continue;let a=r.width;i.push(e/a)}return i}function w(e,t,n){let r=n.length,i=[];for(let a=0;a<r;a++){let r=n[a];r&&i.push({width:Math.floor(e/r),height:Math.floor(t/r)})}return i}function T(t,n){if(n&&n.profile){let r=n.profile;if(r){let n=Array.isArray(r)?r:[r];if(n.includes(`level${t}`)||n.includes(`http://iiif.io/api/image/2/level${t}.json`)||n.includes(`http://iiif.io/api/image/1/level${t}.json`)||n.includes(`http://iiif.io/api/image/1/profiles/level${t}.json`))return!0;if(t===2){for(let t of n)if(e.level2Support.includes(t))return!0}if(t===1){for(let t of n)if(e.level1Support.includes(t))return!0}if(t===0){for(let t of n)if(e.onlyLevel0.includes(t))return!0}}}return!1}function E(e){return d(e)?T(2,e)?2:T(1,e)?1:T(0,e)?0:null:null}function D(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],n=t.length,r=[];for(let e=0;e<n;e++)d(t[e])&&r.push(t[e]);return r}function O(e){if(e[`@type`])return e[`@type`];if(e.type)return e.type}function k(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,``);return t.indexOf(`/`)===-1?t:t.split(`/`)[0]}exports.IIIF_1_IMAGE_LEVEL_0=e.IIIF_1_IMAGE_LEVEL_0,exports.IIIF_1_IMAGE_LEVEL_0_PROFILE=e.IIIF_1_IMAGE_LEVEL_0_PROFILE,exports.IIIF_1_IMAGE_LEVEL_1=e.IIIF_1_IMAGE_LEVEL_1,exports.IIIF_1_IMAGE_LEVEL_1_PROFILE=e.IIIF_1_IMAGE_LEVEL_1_PROFILE,exports.IIIF_1_IMAGE_LEVEL_2=e.IIIF_1_IMAGE_LEVEL_2,exports.IIIF_1_IMAGE_LEVEL_2_PROFILE=e.IIIF_1_IMAGE_LEVEL_2_PROFILE,exports.IIIF_2_IMAGE_LEVEL_0=e.IIIF_2_IMAGE_LEVEL_0,exports.IIIF_2_IMAGE_LEVEL_0_NO_JSON=e.IIIF_2_IMAGE_LEVEL_0_NO_JSON,exports.IIIF_2_IMAGE_LEVEL_0_PROFILE=e.IIIF_2_IMAGE_LEVEL_0_PROFILE,exports.IIIF_2_IMAGE_LEVEL_1=e.IIIF_2_IMAGE_LEVEL_1,exports.IIIF_2_IMAGE_LEVEL_1_NO_JSON=e.IIIF_2_IMAGE_LEVEL_1_NO_JSON,exports.IIIF_2_IMAGE_LEVEL_1_PROFILE=e.IIIF_2_IMAGE_LEVEL_1_PROFILE,exports.IIIF_2_IMAGE_LEVEL_2=e.IIIF_2_IMAGE_LEVEL_2,exports.IIIF_2_IMAGE_LEVEL_2_NO_JSON=e.IIIF_2_IMAGE_LEVEL_2_NO_JSON,exports.IIIF_2_IMAGE_LEVEL_2_PROFILE=e.IIIF_2_IMAGE_LEVEL_2_PROFILE,exports.IIIF_3_IMAGE_LEVEL_0=e.IIIF_3_IMAGE_LEVEL_0,exports.IIIF_3_IMAGE_LEVEL_1=e.IIIF_3_IMAGE_LEVEL_1,exports.IIIF_3_IMAGE_LEVEL_2=e.IIIF_3_IMAGE_LEVEL_2,exports.STANFORD_IIIF_1_IMAGE_COMPLIANCE_0=e.STANFORD_IIIF_1_IMAGE_COMPLIANCE_0,exports.STANFORD_IIIF_1_IMAGE_COMPLIANCE_1=e.STANFORD_IIIF_1_IMAGE_COMPLIANCE_1,exports.STANFORD_IIIF_1_IMAGE_COMPLIANCE_2=e.STANFORD_IIIF_1_IMAGE_COMPLIANCE_2,exports.STANFORD_IIIF_1_IMAGE_CONFORMANCE_0=e.STANFORD_IIIF_1_IMAGE_CONFORMANCE_0,exports.STANFORD_IIIF_1_IMAGE_CONFORMANCE_1=e.STANFORD_IIIF_1_IMAGE_CONFORMANCE_1,exports.STANFORD_IIIF_1_IMAGE_CONFORMANCE_2=e.STANFORD_IIIF_1_IMAGE_CONFORMANCE_2,exports.STANFORD_IIIF_IMAGE_COMPLIANCE_0=e.STANFORD_IIIF_IMAGE_COMPLIANCE_0,exports.STANFORD_IIIF_IMAGE_COMPLIANCE_1=e.STANFORD_IIIF_IMAGE_COMPLIANCE_1,exports.STANFORD_IIIF_IMAGE_COMPLIANCE_2=e.STANFORD_IIIF_IMAGE_COMPLIANCE_2,exports.STANFORD_IIIF_IMAGE_CONFORMANCE_0=e.STANFORD_IIIF_IMAGE_CONFORMANCE_0,exports.STANFORD_IIIF_IMAGE_CONFORMANCE_1=e.STANFORD_IIIF_IMAGE_CONFORMANCE_1,exports.STANFORD_IIIF_IMAGE_CONFORMANCE_2=e.STANFORD_IIIF_IMAGE_CONFORMANCE_2,exports.canonicalServiceUrl=x,exports.combineProfiles=c,exports.createImageServiceRequest=S,exports.extraFeatures=e.extraFeatures,exports.extractFixedSizeScales=C,exports.fixedSizesFromScales=w,exports.getId=u,exports.getImageServiceLevel=E,exports.getImageServices=D,exports.getType=O,exports.identifyImageServer=k,exports.imageServiceProfiles=e.imageServiceProfiles,exports.imageServiceRequestInfo=b,exports.imageServiceRequestToString=y,exports.imageServiceSupportsFormat=m,exports.imageServiceSupportsRequest=h,exports.isImageService=d,exports.isImageServiceLevel=T,exports.isLevel0=l,exports.level0=e.level0,exports.level0Support=e.level0Support,exports.level1=e.level1,exports.level1Support=e.level1Support,exports.level2=e.level2,exports.level2Support=e.level2Support,exports.levelToProfile=s,exports.onlyLevel0=e.onlyLevel0,exports.parseImageServerFromId=t,exports.parseImageServiceRequest=o,exports.parseImageServiceUrl=a,exports.parseRegionParameter=n,exports.parseRotationParameter=i,exports.parseSizeParameter=r,exports.regionParameterToString=g,exports.rotationParameterToString=v,exports.sizeParameterToString=_,exports.supports=f,exports.supportsCustomSizes=p;