import{Traverse as e}from"./traverse-BDmGe7EO.js";import{removeUndefinedProperties as t}from"./remove-undefined-properties-DKmVdOaS.js";const n=/-?([1-9]\d{3,}|0\d{3})-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])T(([01]\d|2[0-3]):[0-5]\d:[0-5]\d(\.\d+)?|(24:00:00(\.0+)?))(Z|(\+|-)((0\d|1[0-3]):[0-5]\d|14:00))?/,r={warnings:[]};function i(e,t=r){return e.behavior&&=o(e.behavior,`behavior`,t),e.width=c(e.width,`width`,!1,t),e.height=c(e.height,`height`,!1,t),e.duration=c(e.duration,`duration`,!0,t),e.format&&typeof e.format!=`string`&&(t.warnings.push(`"format" should be a single string`),Array.isArray(e.format)&&typeof e.format[0]==`string`?e.format=e.format[0]:e.format=void 0),e}function a(e,t,n=r){return e&&Array.isArray(e)?e.filter(e=>{let r=t(e);return r&&n.warnings.indexOf(r)===-1&&n.warnings.push(r),!r}):e}function o(e,t,n=r){return Array.isArray(e)?e:(n.warnings.push(`"${t}" should be Array of values`),[e])}function s(e,t,n=r){return Array.isArray(e)?(n.warnings.push(`"${t}" should only contain a single value`),e.length===0?void 0:e[0]):e}function c(e,t,n=!1,i=r){if(e!==void 0){if(typeof e==`string`){let r=n?parseFloat(e):Math.abs(Number(e));if(Number.isNaN(r)||r<=0){i.warnings.push(`"${t}" expected value to be a ${n?`Number`:`Integer`}, instead found an invalid value`);return}return i.warnings.push(`"${t}" expected value to be a ${n?`Number`:`Integer`}, instead found a string`),r}return!n&&e%1!=0?(i.warnings.push(`"${t}" expected value to be a Integer, instead found a Float`),Math.floor(e)):e}}function l(e,t,n=r){if(Array.isArray(e))return typeof e[0]==`string`?(n.warnings.push(`"${t}" should be a language map instead found a string`),{none:e}):(n.warnings.push(`"${t}" should be a language map instead found an unknown value`),{none:[``]});if(typeof e==`string`)return n.warnings.push(`"${t}" should be a language map instead found a string`),{none:[e]};let i=Object.keys(e),a={},o=!1;for(let r of i){let i=e[r],s=[];if(typeof i==`string`)o=!0,n.warnings.push(`"${t}" values inside a language map should be an Array of strings, found a string`),s.push(i);else if(Array.isArray(i))for(let e of i)typeof e==`string`?s.push(e):(o=!0,n.warnings.push(`"${t}" values inside a language map should be an Array of strings, found an unknown value`));else o=!0,n.warnings.push(`"${t}" values inside a language map should be an Array of strings, found an unknown value`);s.length>0&&(a[r]=s)}return o?Object.keys(a).length===0?{none:[``]}:a:e}function u(e,t,n=``,i=r){return typeof e==`string`?(i.warnings.push(`"${t}" should be a {label, value} set of Language maps`),{label:{none:[n]},value:{none:[e]}}):((!e.label&&e.value||e.label&&!e.value)&&i.warnings.push(`"${t}" should have both a label and a value`),e.label?e.label=l(e.label,`${t}.label`,i):e.label={none:[n]},e.value?e.value=l(e.value,`${t}.value`,i):e.value={none:[``]},e)}function d(e,t=r){if(e.label&&=l(e.label,`label`,t),e.summary&&=l(e.summary,`summary`,t),e.requiredStatement&&=u(e.requiredStatement,`requiredStatement`,`Required statement`,t),e.metadata)if(Array.isArray(e.metadata))for(let n=0;n<e.metadata.length;n++)e.metadata[n]=u(e.metadata[n],`metadata.${n}`,``,t);else t.warnings.push(`"metadata" should be an array of {label, value} Language maps`),e.metadata=[];if(e.rights&&(Array.isArray(e.rights)&&(t.warnings.push(`"rights" should only contain a single string`),e.rights=typeof e.rights[0]==`string`?e.rights[0]:``),typeof e.rights==`string`&&!e.rights.startsWith(`http`)?t.warnings.push(`"rights" should be a valid URI`):typeof e.rights==`string`&&e.rights.startsWith(`https`)&&(t.warnings.push(`"rights" is an informative property and should contain the http variation of the rights statement`),e.rights=`http${e.rights.slice(5)}`)),e.navDate){let r=typeof e.navDate==`string`?e.navDate.trim():void 0;r!==e.navDate&&(t.warnings.push(`"navDate" should not contain extra whitespace`),e.navDate=r),(typeof e.navDate!=`string`||!e.navDate.match(n))&&(t.warnings.push(`"navDate" should be a valid XSD dateTime literal`),e.navDate=void 0)}return e.language&&(e.language=o(e.language,`language`,t),e.language=a(e.language,e=>typeof e==`string`?void 0:`'"language" expected array of strings`,t)),e.accompanyingCanvas&&(e.accompanyingCanvas=s(e.accompanyingCanvas,`accompanyingCanvas`,t),e.accompanyingCanvas?.type!==`Canvas`&&t.warnings.push(`"accompanyingCanvas" should be a Canvas`)),e.placeholderCanvas&&(e.placeholderCanvas=s(e.placeholderCanvas,`placeholderCanvas`,t),e.placeholderCanvas?.type!==`Canvas`&&t.warnings.push(`"placeholderCanvas" should be a Canvas`)),e.thumbnail&&=o(e.thumbnail,`thumbnail`,t),e}const f={Manifest:`Canvas`,Canvas:`AnnotationPage`,AnnotationPage:`Annotation`};function p(e,t=r){let n=e.type;switch(n){case`Canvas`:case`AnnotationPage`:case`Manifest`:e&&e.items&&(e.items=a(e.items,t=>t.type===f[n]?void 0:`"${e.type}.items" should contain only type ${f[n]}, found ${t.type}`,t))}return e}function m(e,t=r){return e.logo&&=o(e.logo,`logo`,t),e.service&&=o(e.service,`service`,t),e.seeAlso&&=o(e.seeAlso,`seeAlso`,t),e.rendering&&=o(e.rendering,`rendering`,t),e.partOf&&=o(e.partOf,`partOf`,t),e.homepage&&=o(e.homepage,`homepage`,t),e.services&&=o(e.services,`services`,t),e.supplementary&&=o(e.supplementary,`supplementary`,t),e.start&&=s(e.start,`start`,t),e}function h(e){return n=>{if(n)return typeof n==`string`||Array.isArray(n)?n:t({...n,...i(n,e),...d(n,e),...m(n,e),...p(n,e)})}}function g(t,n=r){let i=e.all(h(n));return i.traverseManifest(t)}export{g as presentation3StrictUpgrade};
//# sourceMappingURL=strict.js.map