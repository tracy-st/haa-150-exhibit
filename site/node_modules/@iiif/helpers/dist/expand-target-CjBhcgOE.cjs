const e=require(`./chunk-DEHCWMz8.cjs`),t=require(`./defineProperty-65gtPnTc.cjs`);var n=e.__toESM(t.require_defineProperty(),1);function r(e,t,n,r=1){return new c(e,t,n).subdivide(r)}function i(e,t,n,r,i=1){return new l(new Float64Array([e.x,e.y,t.x,t.y,n.x,n.y,r.x,r.y])).subdivide(i)}function a(e){return e.x*e.x+e.y*e.y}function o(e){let t=.67;return e/(1-t+(t**4+.25*e*e)**.25)}function s(e){let t=.39;return e*(1-t+Math.sqrt(t*t+.25*e*e))}var c=class{constructor(e,t,r){(0,n.default)(this,`start`,void 0),(0,n.default)(this,`control`,void 0),(0,n.default)(this,`end`,void 0),this.start=e,this.control=t,this.end=r}eval(e){let t=1-e;return{x:this.start.x*t*t+2*this.control.x*t*e+this.end.x*e*e,y:this.start.y*t*t+2*this.control.y*t*e+this.end.y*e*e}}mapToBasic(){let{x:e,y:t}=this.start,{x:n,y:r}=this.control,{x:i,y:a}=this.end,o=2*n-e-i,s=2*r-t-a,c=(n-e)*o+(r-t)*s,l=(i-n)*o+(a-r)*s,u=(i-e)*s-(a-t)*o,d=c/u,f=l/u,p=Math.abs(u)/(Math.hypot(o,s)*Math.abs(f-d));return{x0:e,x2:i,scale:p,cross:u}}subdivide(e){let t=this.mapToBasic(),n=o(t.x0),r=o(t.x2),i=.5*Math.abs(r-n)*Math.sqrt(t.scale/e),a=Math.ceil(i),c=s(n),l=s(r),u=[0];for(let e=1;e<a;e++){let t=s(n+(r-n)*e/a),i=(t-c)/(l-c);u.push(i)}return u.push(1),u.map(e=>this.eval(e))}},l=class e{constructor(e){(0,n.default)(this,`c`,void 0),this.c=e}weightsum(e,t,n,r){let i=e*this.c[0]+t*this.c[2]+n*this.c[4]+r*this.c[6],a=e*this.c[1]+t*this.c[3]+n*this.c[5]+r*this.c[7];return{x:i,y:a}}eval(e){let t=1-e,n=t*t*t,r=3*t*t*e,i=3*t*e*e,a=e*e*e;return this.weightsum(n,r,i,a)}deriv(e){let t=1-e,n=-3*t*t,r=3*e*e,i=-6*e*t-n,a=6*e*t-r;return this.weightsum(n,i,a,r)}midpoint_quadbez(){let e=this.weightsum(-.25,.75,.75,-.25);return new c({x:this.c[0],y:this.c[1]},e,{x:this.c[6],y:this.c[7]})}subsegment(t,n){let r=new Float64Array(8),i=this.eval(t),a=this.eval(n);r[0]=i.x,r[1]=i.y;let o=(n-t)/3,s=this.deriv(t);r[2]=i.x+o*s.x,r[3]=i.y+o*s.y;let c=this.deriv(n);return r[4]=a.x-o*c.x,r[5]=a.y-o*c.y,r[6]=a.x,r[7]=a.y,new e(r)}subdivide(e){let t=.1*e,n=e-t,r=Math.sqrt(n),i=a(this.weightsum(1,-3,3,-1)),c=Math.ceil((i/(432*t*t))**(1/6)),l=[],u=0;for(let e=0;e<c;e++){let t=e/c,n=(e+1)/c,i=this.subsegment(t,n).midpoint_quadbez(),a=i.mapToBasic(),s=o(a.x0),d=o(a.x2),f=Math.sqrt(a.scale),p=Math.abs(d-s)*f;if(Math.sign(a.x0)!=Math.sign(a.x2)){let e=r/f,t=r*Math.abs(d-s)/o(e);p=Math.max(p,t)}l.push({quad:i,a0:s,a2:d,val:p}),u+=p}let d=.5*u/r,f=Math.ceil(d),p=[{x:this.c[0],y:this.c[1]}],m=0,h=0;for(let e=1;e<f;e++){let t=u*e/f;for(;m+l[h].val<t;)m+=l[h].val,h++;let n=l[h].a0,r=l[h].a2,i=s(n),a=s(r),o=n+(r-n)*(t-m)/l[h].val,c=s(o),d=(c-i)/(a-i);p.push(l[h].quad.eval(d))}return p.push({x:this.c[6],y:this.c[7]}),p}};function u(e){let t={},n=e.replace(/\/\*[\s\S]*?\*\//g,``).replace(/\s+/g,` `).trim(),r=/([^{]+)\{([^}]+)\}/g,i;for(;(i=r.exec(n))!==null;){let e=i[1].trim(),n=i[2].trim(),r=e.match(/\.([a-zA-Z0-9_-]+)/);if(!r)continue;let a=r[1],o=n.split(`;`).filter(e=>e.trim()),s={};for(let e of o){let[t,n]=e.split(`:`).map(e=>e.trim());if(!t||!n)continue;switch(t){case`background-color`:s.backgroundColor=n;break;case`opacity`:s.opacity=parseFloat(n);break;case`box-shadow`:s.boxShadow=n;break;case`border-color`:s.borderColor=n;break;case`border-width`:s.borderWidth=n;break;case`border-style`:s.borderStyle=n;break;case`outline-color`:s.outlineColor=n;break;case`outline-width`:s.outlineWidth=n;break;case`outline-offset`:s.outlineOffset=n;break;case`outline-style`:s.outlineStyle=n;break;case`border`:s.border=n;break;case`outline`:s.outline=n;break;case`background`:s.background=n;break}}t[a]=s}return t}function d(e){let t={};return e?(e.fill&&(t.backgroundColor=e.fill,e.fillOpacity),e.stroke&&(t.borderColor=e.stroke),e.strokeWidth&&(t.borderWidth=e.strokeWidth),t):t}const f=new Map;function p(e,t){if(f.has(e))return f.get(e);let n=u(t);return f.set(e,Object.fromEntries(Object.entries(n).map(([e,t])=>[e,t]))),n}function m(e,t,n={}){if(!e||!t)return d(n||{});let r=d(n||{}),i=Object.entries(t);for(let[t,n]of i){if(!n)continue;let i=p(t,n),a=Object.entries(i);for(let[t,n]of a)t===e&&Object.assign(r,n)}return r}var h=e.__commonJSMin(((exports,t)=>{Object.defineProperty(exports,`__esModule`,{value:!0});var n=function(){function e(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o=e[Symbol.iterator](),s;!(r=(s=o.next()).done)&&(n.push(s.value),!(t&&n.length===t));r=!0);}catch(e){i=!0,a=e}finally{try{!r&&o.return&&o.return()}finally{if(i)throw a}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw TypeError(`Invalid attempt to destructure non-iterable instance`)}}(),r=Math.PI*2,i=function(e,t,n,r,i,a,o){var s=e.x,c=e.y;s*=t,c*=n;var l=r*s-i*c,u=i*s+r*c;return{x:l+a,y:u+o}},a=function(e,t){var n=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:4/3*Math.tan(t/4),r=Math.cos(e),i=Math.sin(e),a=Math.cos(e+t),o=Math.sin(e+t);return[{x:r-i*n,y:i+r*n},{x:a+o*n,y:o-a*n},{x:a,y:o}]},o=function(e,t,n,r){var i=e*r-t*n<0?-1:1,a=e*n+t*r;return a>1&&(a=1),a<-1&&(a=-1),i*Math.acos(a)},s=function(e,t,n,i,a,s,c,l,u,d,f,p){var m=a**2,h=s**2,g=f**2,_=p**2,v=m*h-m*_-h*g;v<0&&(v=0),v/=m*_+h*g,v=Math.sqrt(v)*(c===l?-1:1);var y=v*a/s*p,b=v*-s/a*f,x=d*y-u*b+(e+n)/2,S=u*y+d*b+(t+i)/2,C=(f-y)/a,w=(p-b)/s,T=(-f-y)/a,E=(-p-b)/s,D=o(1,0,C,w),O=o(C,w,T,E);return l===0&&O>0&&(O-=r),l===1&&O<0&&(O+=r),[x,S,D,O]},c=function(e){var t=e.px,o=e.py,c=e.cx,l=e.cy,u=e.rx,d=e.ry,f=e.xAxisRotation,p=f===void 0?0:f,m=e.largeArcFlag,h=m===void 0?0:m,g=e.sweepFlag,_=g===void 0?0:g,v=[];if(u===0||d===0)return[];var y=Math.sin(p*r/360),b=Math.cos(p*r/360),x=b*(t-c)/2+y*(o-l)/2,S=-y*(t-c)/2+b*(o-l)/2;if(x===0&&S===0)return[];u=Math.abs(u),d=Math.abs(d);var C=x**2/u**2+S**2/d**2;C>1&&(u*=Math.sqrt(C),d*=Math.sqrt(C));var w=s(t,o,c,l,u,d,h,_,y,b,x,S),T=n(w,4),E=T[0],D=T[1],O=T[2],k=T[3],A=Math.abs(k)/(r/4);Math.abs(1-A)<1e-7&&(A=1);var j=Math.max(Math.ceil(A),1);k/=j;for(var M=0;M<j;M++)v.push(a(O,k)),O+=k;return v.map(function(e){var t=i(e[0],u,d,b,y,E,D),n=t.x,r=t.y,a=i(e[1],u,d,b,y,E,D),o=a.x,s=a.y,c=i(e[2],u,d,b,y,E,D),l=c.x,f=c.y;return{x1:n,y1:r,x2:o,y2:s,x:l,y:f}})};exports.default=c,t.exports=exports.default})),g=e.__commonJSMin(((exports,t)=>{t.exports=i;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=/([astvzqmhlc])([^astvzqmhlc]*)/gi;function i(e){var t=[];return e.replace(r,function(e,r,i){var a=r.toLowerCase();for(i=o(i),a==`m`&&i.length>2&&(t.push([r].concat(i.splice(0,2))),a=`l`,r=r==`m`?`l`:`L`);;){if(i.length==n[a])return i.unshift(r),t.push(i);if(i.length<n[a])throw Error(`malformed path data`);t.push([r].concat(i.splice(0,n[a])))}}),t}var a=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function o(e){var t=e.match(a);return t?t.map(Number):[]}})),_=e.__commonJSMin(((exports,t)=>{t.exports=n;function n(e){var t=0,n=0,r=0,i=0;return e.map(function(e){e=e.slice();var a=e[0],o=a.toUpperCase();if(a!=o)switch(e[0]=o,a){case`a`:e[6]+=r,e[7]+=i;break;case`v`:e[1]+=i;break;case`h`:e[1]+=r;break;default:for(var s=1;s<e.length;)e[s++]+=r,e[s++]+=i}switch(o){case`Z`:r=t,i=n;break;case`H`:r=e[1];break;case`V`:i=e[1];break;case`M`:r=t=e[1],i=n=e[2];break;default:r=e[e.length-2],i=e[e.length-1]}return e})}})),v=e.__toESM(h(),1),y=e.__toESM(g(),1),b=e.__toESM(_(),1);function x(e){let t=(0,y.default)(e),n=(0,b.default)(t),r,i=0,a=0,o=0,s=0,c,l,u=0,d=0,f=[];for(let e=0;e<n.length;e++){let t=n[e],p=t[0];switch(p){case`M`:i=t[1],a=t[2];break;case`H`:t=[`L`,t[1],a];break;case`V`:t=[`L`,i,t[1]];break;case`S`:{let e=u,n=d;(r===`C`||r==`S`)&&(e+=e-o,n+=n-s),t=[`C`,e,n,t[1],t[2],t[3],t[4]]}break;case`T`:r===`Q`||r==`T`?(c=u*2-c,l=d*2-l):(c=u,l=d),t=[`Q`,c,l,t[1],t[2]];break;case`Q`:c=t[1],l=t[2];break;case`A`:{let e=(0,v.default)({px:u,py:d,cx:t[6],cy:t[7],rx:t[1],ry:t[2],xAxisRotation:t[3],largeArcFlag:t[4],sweepFlag:t[5]});if(!e.length)continue;for(let[n,r]of e.entries())t=[`C`,r.x1,r.y1,r.x2,r.y2,r.x,r.y],n<e.length-1&&f.push(t);t=t}break;case`Z`:t=[`L`,i,a];break}r=p,u=t[t.length-2],d=t[t.length-1],[`C`,`Q`,`A`].indexOf(p)>-1?(o=t[t.length-4],s=t[t.length-3]):(o=u,s=d),f.push(t)}return f}const S=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,C=/&?(t=)(npt:)?([0-9]+(\.[0-9]+)?)?(,([0-9]+(\.[0-9]+)?))?/,w=/^rgba\((\d+),(\d+),(\d+),([0-9.]+)\)$/;function T(e,{domParser:t,svgPreprocessor:n,iiifRenderingHints:r,loadedStylesheets:i}={},{styleClass:a}={}){if(Array.isArray(e))return j(e.reduce((e,i)=>{let{selector:o,selectors:s,iiifRenderingHints:c}=T(i,{domParser:t,svgPreprocessor:n,iiifRenderingHints:r},{styleClass:a});return o&&(e.selector?(!e.selector.temporal&&o.temporal&&(e.selector.temporal=o.temporal),!e.selector.spatial&&o.spatial&&(e.selector.spatial=o.spatial),!e.selector.svg&&o.svg&&(e.selector.svg=o.svg),!e.selector.svgShape&&o.svgShape&&(e.selector.svgShape=o.svgShape)):e.selector=o,e.selectors.push(...s)),c&&(e.iiifRenderingHints=e.iiifRenderingHints||{type:`ImageApiSelector`},Object.assign(e.iiifRenderingHints,c)),e},{selector:null,selectors:[],iiifRenderingHints:r}));if(!e)return j({selector:null,selectors:[],iiifRenderingHints:r});if(typeof e==`string`){let[i,o]=e.split(`#`);return o?T({type:`FragmentSelector`,value:o},{svgPreprocessor:n,iiifRenderingHints:r,domParser:t},{styleClass:a}):j({selector:null,selectors:[],iiifRenderingHints:r})}if(e.type){if(e.type===`PointSelector`&&(e.t||e.t===0)){let t={type:`TemporalSelector`,temporal:{startTime:e.t}};return j({selector:t,selectors:[t],iiifRenderingHints:r})}if(e.type===`PointSelector`&&e.x&&e.y){let t={type:`PointSelector`,spatial:{x:e.x,y:e.y}};return j({selector:t,selectors:[t],iiifRenderingHints:r})}}if(A(e)){let i=[];if(e.region){let o=T({type:`FragmentSelector`,value:`xywh=`+e.region},{domParser:t,svgPreprocessor:n,iiifRenderingHints:r},{styleClass:a});i.push(...o.selectors)}return j({selector:i[0],selectors:i,iiifRenderingHints:r?{...r,...e}:e})}if(e.type===`FragmentSelector`){let t=S.exec(e.value);if(t){let n={type:`BoxSelector`,spatial:{unit:t[2]===`percent:`||t[2]===`pct:`?`percent`:`pixel`,x:Number.parseFloat(t[3]),y:Number.parseFloat(t[4]),width:Number.parseFloat(t[5]),height:Number.parseFloat(t[6])},boxStyle:m(a,i)},o=e.value.match(C);return o&&(n={type:`TemporalBoxSelector`,spatial:n.spatial,temporal:{startTime:o[3]?Number.parseFloat(o[3]):0,endTime:o[6]?Number.parseFloat(o[6]):void 0},boxStyle:m(a,i)}),j({selector:n,selectors:[n],iiifRenderingHints:r})}let n=e.value.match(C);if(n){let e={type:`TemporalSelector`,temporal:{startTime:n[3]?Number.parseFloat(n[3]):0,endTime:n[6]?Number.parseFloat(n[6]):void 0}};return j({selector:e,selectors:[e],iiifRenderingHints:r})}return j({selector:null,selectors:[],iiifRenderingHints:r})}if(e.type===`SvgSelector`&&`value`in e){t||(typeof window<`u`?t=new window.DOMParser:console.warn("No DOMParser available, cannot parse SVG selector, `points`, `spatial` and `style` will be unavailable and the SVG will not be normalized."));let o=[],s,c,l=n?.(e.value)??e.value,u;if(t){let n=t.parseFromString(e.value,`image/svg+xml`).querySelector(`svg`);if(!n)return console.warn(`Illegal SVG selector: ${e.value}`),j({selector:null,selectors:[],iiifRenderingHints:r});let i=D(n);i&&(o=i.points,u=i.shapeType,s=[Math.min(...o.map(e=>e[0])),Math.min(...o.map(e=>e[1])),Math.max(...o.map(e=>e[0])),Math.max(...o.map(e=>e[1]))],{style:c,svg:l}=k(i.element)??{svg:l})}let d={type:`SvgSelector`,svg:l,svgShape:u,style:c,boxStyle:m(a,i,c),points:o.length?o:void 0,spatial:s?{unit:`pixel`,x:s[0],y:s[1],width:s[2]-s[0],height:s[3]-s[1]}:void 0};return j({selector:d,selectors:[d],iiifRenderingHints:r})}return j({selector:null,selectors:[],iiifRenderingHints:r})}function E(e){let t=e.map(e=>e[0]).reduce((e,t)=>(e[t]+=1,e),{C:0,Q:0,L:0,M:0}),n=new Set(e.map(e=>e[0]));if(t.C>0||t.Q>0)return`path`;if(t.L>0&&(n.size===1||n.size===2&&n.has(`M`))){if(t.L===4)return`rect`;let n=e.slice(-1)[0];return e[0][0]===`M`&&n[0]===`L`&&n[1]==e[0][1]&&n[2]===e[0][2]||n[1]===0&&n[2]===0?`polygon`:`polyline`}return`path`}function D(e){for(let t of Array.from(e.children))switch(t?.tagName.toLowerCase()){case`g`:{let e=D(t);if(e)return e}continue;case`path`:{let e=t.getAttribute(`d`);if(!e)continue;let n=x(e);return{element:t,points:O(n),shapeType:E(n)}}case`circle`:{let e=Number.parseFloat(t.getAttribute(`cx`)??`0`),n=Number.parseFloat(t.getAttribute(`cy`)??`0`),r=Number.parseFloat(t.getAttribute(`r`)??`0`);if(!r)continue;let i=[];for(let t=0;t<=360;t+=12){let a=t*Math.PI/180;i.push([e+r*Math.cos(a),n+r*Math.sin(a)])}return{element:t,points:i,shapeType:`circle`}}case`ellipse`:{let e=Number.parseFloat(t.getAttribute(`cx`)??`0`),n=Number.parseFloat(t.getAttribute(`cy`)??`0`),r=Number.parseFloat(t.getAttribute(`rx`)??`0`),i=Number.parseFloat(t.getAttribute(`ry`)??`0`);if(!r&&!i)continue;let a=[];for(let t=0;t<=360;t+=12){let o=Math.tan(t/360*Math.PI),s=r*(1-o**2)/(1+o**2),c=i*2*o/(1+o**2);a.push([e+s,n+c])}return{element:t,points:a,shapeType:`ellipse`}}case`line`:{let e=Number.parseFloat(t.getAttribute(`x0`)??`0`),n=Number.parseFloat(t.getAttribute(`y0`)??`0`),r=Number.parseFloat(t.getAttribute(`x1`)??`0`),i=Number.parseFloat(t.getAttribute(`y1`)??`0`);if(e===r&&n===i)continue;return{element:t,points:[[e,n],[r,i]],shapeType:`polyline`}}case`polygon`:case`polyline`:{let e=t.getAttribute(`points`)?.split(` `).map(e=>e.split(`,`).map(Number.parseFloat))??[];if(!e.length)continue;let n=`polyline`;return t.tagName.toLowerCase()===`polygon`&&(e.push(e[0]),n=`polygon`),{element:t,points:e,shapeType:n}}case`rect`:{let e=Number.parseFloat(t.getAttribute(`x`)??`0`),n=Number.parseFloat(t.getAttribute(`y`)??`0`),r=Number.parseFloat(t.getAttribute(`width`)??`0`),i=Number.parseFloat(t.getAttribute(`height`)??`0`);if(!r||!i)continue;return{element:t,points:[[e,n],[e+r,n],[e+r,n+i],[e,n+i],[e,n]],shapeType:`rect`}}default:continue}return null}function O(e){let t=[];for(let n=0;n<e.length;n++){let a=t[t.length-1]??[0,0],o=e[n];switch(o[0]){case`M`:case`L`:t.push([o[1],o[2]]);continue;case`C`:t.push(...i({x:a[0],y:a[1]},{x:o[1],y:o[2]},{x:o[3],y:o[4]},{x:o[5],y:o[6]}).map(e=>[e.x,e.y]).slice(1));continue;case`Q`:t.push(...r({x:a[0],y:a[1]},{x:o[1],y:o[2]},{x:o[3],y:o[4]}).map(e=>[e.x,e.y]).slice(1));continue}}return t}function k(e){let t={};if(e.hasAttribute(`fill`)?(t.fill=e.getAttribute(`fill`),e.removeAttribute(`fill`)):e.style&&e.style.fill&&(t.fill=e.style.fill),t.fill){let e=w.exec(t.fill);e&&(t.fillOpacity=Number.parseFloat(e[4]),t.fill=`rgb(${e[1]}, ${e[2]}, ${e[3]})`)}if(e.hasAttribute(`fill-opacity`)?(t.fillOpacity=Number.parseFloat(e.getAttribute(`fill-opacity`)),e.removeAttribute(`fill-opacity`)):e.style&&e.style.fillOpacity&&(t.fillOpacity=Number.parseFloat(e.style.fillOpacity)),e.hasAttribute(`stroke`)?(t.stroke=e.getAttribute(`stroke`),e.removeAttribute(`stroke`)):e.style&&e.style.stroke&&(t.stroke=e.style.stroke),t.stroke){let e=w.exec(t.stroke);e&&(t.strokeOpacity=Number.parseFloat(e[4]),t.stroke=`rgb(${e[1]}, ${e[2]}, ${e[3]})`)}e.hasAttribute(`stroke-opacity`)?(t.strokeOpacity=Number.parseFloat(e.getAttribute(`stroke-opacity`)),e.removeAttribute(`stroke-opacity`)):e.style&&e.style.strokeOpacity&&(t.strokeOpacity=Number.parseFloat(e.style.strokeOpacity)),e.hasAttribute(`stroke-width`)?(t.strokeWidth=e.getAttribute(`stroke-width`),e.removeAttribute(`stroke-width`)):e.style&&e.style.strokeWidth&&(t.strokeWidth=e.style.strokeWidth),e.hasAttribute(`stroke-dasharray`)?(t.strokeDasharray=e.getAttribute(`stroke-dasharray`),e.removeAttribute(`stroke-dasharray`)):e.style&&e.style.strokeDasharray&&(t.strokeDasharray=e.style.strokeDasharray);let n=e;for(;n.tagName.toLowerCase()!==`svg`;)if(n=n.parentElement,n===null)throw Error(`Could not find root SVG element`);return{svg:n.outerHTML,style:Object.keys(t).length>0?t:void 0}}function A(e){if(!e)return!1;let t=e.type||e[`@type`];return t===`iiif:ImageApiSelector`||t===`ImageApiSelector`}function j(e){if(e.iiifRenderingHints){let t=e.iiifRenderingHints;if(t.rotation){let n=M(`${t.rotation}`);if(n)if(e.selectors.length)for(let t of e.selectors)t.rotation=n;else e.selectors.push({type:`RotationSelector`,rotation:n})}}else delete e.iiifRenderingHints;return e}function M(e){let t=Number.parseFloat(e);return t&&e.startsWith(`!`)&&(t=360-t),t&&(t%=360),t===t&&t||0}function N(e,t={}){if(Array.isArray(e))return N(e[0]);if(typeof e==`string`){let[n,r]=e.split(`#`);return r?N({type:`SpecificResource`,source:{id:n,type:t.typeMap&&t.typeMap[n]||t.defaultType||`Canvas`},selector:{type:`FragmentSelector`,value:r}},t):{type:`SpecificResource`,source:{id:n,type:t.typeMap&&t.typeMap[n]||t.defaultType||`Canvas`},selector:null,selectors:[]}}if(e.type===`Choice`||e.type===`List`||e.type===`Composite`||e.type===`Independents`)return N(e.items[0],t);if(!e.type&&`source`in e&&(e.type=`SpecificResource`),e.type===`SpecificResource`){e.source.type===`Canvas`&&e.source.partOf&&typeof e.source.partOf==`string`&&(e.source.partOf=[{id:e.source.partOf,type:`Manifest`}]);let n=e.styleClass||t.styleClass,r={selector:null,selectors:[]};if(typeof e.source==`string`&&e.source.includes(`#`)){let i=N(e.source,{...t,styleClass:n});e.source=i.source,r={selector:i.selector,selectors:i.selectors}}let{selector:i,selectors:a}=e.selector?T(e.selector,t,{styleClass:n}):r;return{type:`SpecificResource`,source:e.source,selector:i,selectors:a}}if(e.id){e.type===`Canvas`&&e.partOf&&typeof e.partOf==`string`&&(e.partOf=[{id:e.partOf,type:`Manifest`}]);let[n,r]=e.id.split(`#`);return r?N({type:`SpecificResource`,source:{...e,id:n},selector:{type:`FragmentSelector`,value:r}},t):{type:`SpecificResource`,source:{...e,id:n},selector:null,selectors:[]}}return{type:`SpecificResource`,source:e,selector:null,selectors:[]}}Object.defineProperty(exports,`expandTarget`,{enumerable:!0,get:function(){return N}}),Object.defineProperty(exports,`isImageApiSelector`,{enumerable:!0,get:function(){return A}}),Object.defineProperty(exports,`parseRotation`,{enumerable:!0,get:function(){return M}}),Object.defineProperty(exports,`parseSelector`,{enumerable:!0,get:function(){return T}});