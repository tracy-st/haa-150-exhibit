{"version":3,"file":"compat-167ipRuK.js","names":["metaState: any","compatVault: CompatVault"],"sources":["../src/compat.ts"],"sourcesContent":["export type CompatVault = {\n  get: import('./vault').Vault['get'];\n  setMetaValue: import('./vault').Vault['setMetaValue'];\n  getResourceMeta: import('./vault').Vault['getResourceMeta'];\n  load: import('./vault').Vault['load'];\n  requestStatus: import('./vault').Vault['requestStatus'];\n};\n\nconst metaState: any = {};\nexport const compatVault: CompatVault = {\n  get(nonRef: any) {\n    return nonRef;\n  },\n  setMetaValue([id, meta, key], value) {\n    const oldValue = compatVault.getResourceMeta(id, meta);\n    const oldValueItem = oldValue ? oldValue[key] : undefined;\n    const newValue = typeof value === 'function' ? (value as any)(oldValueItem) : value;\n    metaState[id] = {\n      ...(metaState[id] || {}),\n      [meta]: {\n        ...((metaState[id] || {})[meta] || {}),\n        [key]: newValue,\n      },\n    };\n  },\n  getResourceMeta: ((resource: any, metaKey?: any) => {\n    const resourceMeta = metaState[resource as any] as any;\n\n    if (!resourceMeta) {\n      return undefined;\n    }\n    if (!metaKey) {\n      return resourceMeta;\n    }\n\n    return resourceMeta[metaKey];\n  }) as any,\n  async load(id: string | { type: any; id: string }) {\n    const idToLoad = typeof id === 'string' ? id : id.id;\n\n    // @todo this could do an upgrade..\n    return fetch(idToLoad).then((response) => response.json());\n  },\n  requestStatus(id: string) {\n    // Never any request status in this context.\n    return undefined;\n  },\n};\n"],"mappings":"AAQA,MAAMA,EAAiB,GACVC,EAA2B,CACtC,IAAI,EAAa,CACf,OAAO,GAET,aAAa,CAAC,EAAI,EAAM,GAAM,EAAO,CACnC,IAAM,EAAW,EAAY,gBAAgB,EAAI,GAC3C,EAAe,EAAW,EAAS,GAAO,IAAA,GAC1C,EAAW,OAAO,GAAU,WAAc,EAAc,GAAgB,EAC9E,EAAU,GAAM,CACd,GAAI,EAAU,IAAO,IACpB,GAAO,CACN,IAAK,EAAU,IAAO,IAAI,IAAS,IAClC,GAAM,KAIb,kBAAmB,EAAe,IAAkB,CAClD,IAAM,EAAe,EAAU,GAE1B,KAOL,OAJK,EAIE,EAAa,GAHX,IAKX,MAAM,KAAK,EAAwC,CACjD,IAAM,EAAW,OAAO,GAAO,SAAW,EAAK,EAAG,GAGlD,OAAO,MAAM,GAAU,KAAM,GAAa,EAAS,SAErD,cAAc,EAAY"}