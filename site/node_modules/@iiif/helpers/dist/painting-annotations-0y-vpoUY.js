import{compatVault as e}from"./compat-167ipRuK.js";function t(e){return e.type===`SpecificResource`?[e.source,{selector:e.selector}]:[e,{selector:null}]}function n(n=e){function r(e){let t=e?typeof e==`string`?n.get(e):e:null;if(!t)return[];let r=n.get(t.items,{parent:t}),i=[];for(let e of r)i.push(...n.get(e.items,{parent:e}));return i}function i(e,i=[]){let a=Array.isArray(e)?e:r(e),o=[],s={items:[],type:`complex-choice`},c=[];for(let e of a){if(e.type!==`Annotation`)throw Error(`getPaintables() accept either a canvas or list of annotations`);let r=Array.from(Array.isArray(e.body)?e.body:[e.body]);for(let a of r){let[l,{selector:u}]=t(a),d=n.get(l),f=(d.type||`unknown`).toLowerCase();if(f===`choice`){let e=n.get(d.items,{parent:d.id}),t=i.length?i.map(t=>e.find(e=>e.id===t)).filter(Boolean):[e[0]];t.length===0&&t.push(e[0]),s.items.push({type:`single-choice`,items:e.map(e=>({id:e.id,label:e.label,selected:t.indexOf(e)!==-1})),label:l.label}),r.push(...t);continue}o.indexOf(f)===-1&&o.push(f),c.push({type:f,annotationId:e.id,annotation:e,resource:d,target:e.target,selector:u})}}return{types:o,items:c,choice:s.items.length<2?s.items[0]||null:s,allChoices:s.items.length?s:null}}function a(e){let{choice:t}=i(e);return t}return{getAllPaintingAnnotations:r,getPaintables:i,extractChoices:a}}export{n as createPaintingAnnotationsHelper,t as parseSpecificResource};
//# sourceMappingURL=painting-annotations-0y-vpoUY.js.map